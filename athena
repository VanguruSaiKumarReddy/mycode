-- Replace <your_table_name> and the account IDs below.
WITH acct_list(account_id) AS (
    SELECT * FROM (
        VALUES
            ROW('111111111111'),
            ROW('222222222222'),
            ROW('333333333333')
    )
)
SELECT
    t.accountid      AS account_id,
    t.instanceid     AS instance_id,
    COALESCE(t.region, t.awsregion) AS region
FROM platforminventory.<your_table_name> AS t
JOIN acct_list a
  ON CAST(t.accountid AS varchar) = a.account_id
WHERE t.instanceid LIKE 'i-%'
  -- uncomment if your table has instance state
  -- AND COALESCE(t.state, t.instancestate, t.lifecycle_state) <> 'terminated'
GROUP BY 1,2,3
ORDER BY 1,3,2;
