#!/usr/bin/env bash
set -euo pipefail

# Grab region and instance-id from IMDS
REGION=$(curl -s http://169.254.169.254/latest/dynamic/instance-identity/document | grep region | cut -d\" -f4)
IID=$(curl -s http://169.254.169.254/latest/meta-data/instance-id)

# Fetch the Name tag using AWS CLI
aws ec2 describe-tags \
  --region "$REGION" \
  --filters "Name=resource-id,Values=$IID" "Name=key,Values=Name" \
  --query "Tags[0].Value" \
  --output text
