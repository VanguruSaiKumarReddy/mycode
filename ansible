- name: "CIS 4.2.2.3 | Ensure journald is configured to compress large log files"
  lineinfile:
    path: /etc/systemd/journald.conf
    regexp: '^\s*Compress='
    line: 'Compress=yes'
    create: yes
    mode: '0644'
  notify: restart_systemd_journald
  tags: ['cis_4_2_2_3','cis','journald']



- name: restart_systemd_journald
  service:
    name: systemd-journald
    state: restarted



# Check config file
grep -E '^\s*Compress=yes' /etc/systemd/journald.conf

# Confirm journald picked it up
systemctl show systemd-journald | grep Compress
